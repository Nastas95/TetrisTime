<html>
  <head>
    <title>Configuration</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
    <script type="text/javascript">
      var options = {};
      
      function parse_options() {
        if (location.search) {
          var prefix = "?options="
          if (location.search.indexOf(prefix) == 0) {
            var json_str = unescape(location.search.substring(prefix.length));
            console.log("Got options: " + json_str);
            options = JSON.parse(json_str);

            for (var key in options) {
              var name = "#" + key + "_" + options[key];
              console.log("checking " + name);
              $(name).prop("checked", true);
              $("input[name='" + key + "']").checkboxradio("refresh");
            }
          }
        }
      }
      function save() {
        $("input").each(function (index) {
          var name = this.name
          var checked = Number($("#" + name + "_1").prop("checked"));
          options[name] = checked;
          console.log("Got " + name + ":" + checked)
        })
        console.log("Save: " + JSON.stringify(options));
        document.location = "pebblejs://close#" + encodeURIComponent(options);
      }
      function cancel() {
        console.log("Cancel");
        document.location = "pebblejs://close";
      }
    </script>
  </head>
  <body onload="parse_options()">
    <h2>Configuration</h2>
    <p>
      <h3>Theme</h3>
      <input name="DARK_THEME" id="DARK_THEME_0" value="0" checked="checked" type="radio">
      <label for="DARK_THEME_0">Light theme</label>
      <input name="DARK_THEME" id="DARK_THEME_1" value="0" checked="checked" type="radio">
      <label for="DARK_THEME_1">Dark theme</label>
    </p>
    <p>
      <h3>Digits style</h3>
      <input name="COMPACT_DIGITS" id="COMPACT_DIGITS_0" value="0" checked="checked" type="radio">
      <label for="COMPACT_DIGITS_0">Sparse digits</label>
      <input name="COMPACT_DIGITS" id="COMPACT_DIGITS_1" value="0" checked="checked" type="radio">
      <label for="COMPACT_DIGITS_1">Compact digits</label>
    </p>
    <p>
      <h3>Colon style</h3>
      <input name="ANIMATE_SECOND_DOT" id="ANIMATE_SECOND_DOT_0" value="0" checked="checked" type="radio">
      <label for="ANIMATE_SECOND_DOT_0">Static colon</label>
      <input name="ANIMATE_SECOND_DOT" id="ANIMATE_SECOND_DOT_1" value="0" checked="checked" type="radio">
      <label for="ANIMATE_SECOND_DOT_1">Blinking colon</label>
    </p>
    <p>
      <div class="ui-block-b" style="float:left;margin:10"><button type="submit" data-theme="a" id="save" onclick="save()">Save</button></div>
      <div class="ui-block-a" style="float:right;margin:10"><button type="submit" data-theme="d" id="cancel" onclick="cancel()">Cancel</button></div>
    </p>
  </body>
</html>
